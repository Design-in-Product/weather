<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Sketch 7 — Season Fill Gauge</title>
<style>
  :root {
    --bg: #0a0e17;
    --bg-card: #0f1923;
    --bg-deep: #080b12;
    --text: #c8d6e5;
    --text-bold: #fff;
    --muted: #5f7d9a;
    --dim: #3d566e;
    --border: #1a2332;
    --accent: #34c6c6;
    --accent-light: #6ee7e7;
    --accent-dark: #0e5a6f;
    --grid: #1a2332;
    --tooltip-bg: #1a2332;
    --tooltip-border: #2d4055;
    --shadow: rgba(0,0,0,0.5);
    --mark-line: rgba(255,255,255,0.08);
  }
  body.light {
    --bg: #f5f7fa;
    --bg-card: #ffffff;
    --bg-deep: #f0f0f4;
    --text: #2d3748;
    --text-bold: #1a202c;
    --muted: #64748b;
    --dim: #94a3b8;
    --border: #e2e8f0;
    --accent: #0891b2;
    --accent-light: #06b6d4;
    --accent-dark: #164e63;
    --grid: #e2e8f0;
    --tooltip-bg: #ffffff;
    --tooltip-border: #e2e8f0;
    --shadow: rgba(0,0,0,0.1);
    --mark-line: rgba(0,0,0,0.08);
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: 'SF Mono', 'Menlo', monospace; background: var(--bg); color: var(--text); padding: 32px; display: flex; flex-direction: column; align-items: center; }
  h1 { font-size: 14px; text-transform: uppercase; letter-spacing: 2px; color: var(--muted); margin-bottom: 4px; }
  .subtitle { font-size: 11px; color: var(--dim); margin-bottom: 32px; }
  .gauge-wrap { position: relative; width: 240px; height: 400px; }
  .gauge-outer { width: 240px; height: 400px; border-radius: 0 0 120px 120px; border: 2px solid var(--border);
                overflow: hidden; position: relative; background: var(--bg-deep); }
  .gauge-fill { position: absolute; bottom: 0; left: 0; right: 0; border-radius: 0 0 118px 118px;
               transition: height 1.5s cubic-bezier(0.23, 1, 0.32, 1); }
  .gauge-marks { position: absolute; top: 0; left: 0; right: 0; bottom: 0; }
  .mark { position: absolute; left: 0; right: 0; display: flex; align-items: center; }
  .mark-line { flex: 1; height: 1px; background: var(--mark-line); }
  .mark-label { font-size: 9px; color: var(--dim); padding: 0 8px; white-space: nowrap; }
  .center-num { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
               text-align: center; z-index: 2; }
  .center-num .big { font-size: 48px; font-weight: bold; color: var(--text-bold); text-shadow: 0 2px 20px var(--shadow); }
  .center-num .unit { font-size: 14px; color: var(--muted); }
  .center-num .pct { font-size: 18px; color: var(--accent); margin-top: 4px; }
  .wave { position: absolute; bottom: 0; left: -50%; width: 200%; height: 20px; z-index: 1; }
  .month-markers { display: flex; gap: 20px; margin-top: 24px; justify-content: center; flex-wrap: wrap; }
  .mm { display: flex; align-items: center; gap: 6px; font-size: 11px; }
  .mm .dot { width: 8px; height: 8px; border-radius: 50%; }
  .side-stats { display: flex; gap: 32px; margin-top: 32px; }
  .side-stat { text-align: center; padding: 16px; background: var(--bg-card); border-radius: 8px; border: 1px solid var(--border); }
  .side-stat .num { font-size: 24px; font-weight: bold; color: var(--accent); }
  .side-stat .label { font-size: 10px; color: var(--muted); text-transform: uppercase; letter-spacing: 1px; margin-top: 4px; }
</style>
</head>
<body>
<h1>Season Fill Gauge</h1>
<p class="subtitle">How full is the rain season bucket? Target: ~15.5" (30-yr avg)</p>
<div class="gauge-wrap">
  <div class="gauge-outer" id="gauge">
    <div class="gauge-fill" id="fill"></div>
    <svg class="wave" id="wave" viewBox="0 0 400 20" preserveAspectRatio="none">
      <path d="" fill="rgba(110,231,231,0.15)">
        <animate attributeName="d"
          values="M0,10 C100,0 200,20 300,10 C350,5 380,15 400,10 L400,20 L0,20 Z;
                  M0,10 C100,20 200,0 300,10 C350,15 380,5 400,10 L400,20 L0,20 Z;
                  M0,10 C100,0 200,20 300,10 C350,5 380,15 400,10 L400,20 L0,20 Z"
          dur="3s" repeatCount="indefinite"/>
      </path>
    </svg>
    <div class="gauge-marks" id="marks"></div>
    <div class="center-num">
      <div class="big" id="bigNum">0</div>
      <div class="unit">inches</div>
      <div class="pct" id="pctText">0% of avg</div>
    </div>
  </div>
</div>
<div class="month-markers" id="monthMarkers"></div>
<div class="side-stats">
  <div class="side-stat"><div class="num" id="daysLeft">—</div><div class="label">Days left in season</div></div>
  <div class="side-stat"><div class="num" id="needed">—</div><div class="label">Needed to hit avg</div></div>
  <div class="side-stat"><div class="num" id="pace">—</div><div class="label">Needed per day</div></div>
</div>
<script>
const TOTAL = 10.95;
const AVG = 15.5;
const PCT = TOTAL / AVG;
const SEASON_DAYS = 365; // Oct-Sep
const ELAPSED = 137; // Oct 1 to Feb 14
const REMAINING = SEASON_DAYS - ELAPSED;

// Monthly breakdown for the colored layers
const MONTHS = [
  { name: 'Oct', total: 0.83, color: '#1a5a2e' },
  { name: 'Nov', total: 3.02, color: '#2d6a4f' },
  { name: 'Dec', total: 3.64, color: '#0e5a6f' },
  { name: 'Jan', total: 2.96, color: '#1a8a8a' },
  { name: 'Feb', total: 0.50, color: '#34c6c6' },
];

// Fill gauge
const fill = document.getElementById('fill');
const fillPct = Math.min(PCT, 1) * 100;

// Gradient for fill
const grad = MONTHS.map((m, i) => {
  const start = MONTHS.slice(0, i).reduce((a, x) => a + x.total, 0) / TOTAL * 100;
  return `${m.color} ${start}%`;
}).join(', ');
fill.style.background = `linear-gradient(0deg, ${grad}, #34c6c6 100%)`;

requestAnimationFrame(() => {
  fill.style.height = fillPct + '%';
});

// Marks
const marks = document.getElementById('marks');
[5, 10, 15].forEach(v => {
  const pct = v / AVG;
  if (pct > 1) return;
  const mk = document.createElement('div');
  mk.className = 'mark';
  mk.style.bottom = (pct * 100) + '%';
  mk.innerHTML = `<span class="mark-label">${v}"</span><div class="mark-line"></div>`;
  marks.appendChild(mk);
});

// Animate number
const bigNum = document.getElementById('bigNum');
const pctText = document.getElementById('pctText');
let current = 0;
const step = TOTAL / 40;
function animateNum() {
  current = Math.min(current + step, TOTAL);
  bigNum.textContent = current.toFixed(1);
  pctText.textContent = Math.round(current / AVG * 100) + '% of avg';
  if (current < TOTAL) requestAnimationFrame(animateNum);
}
requestAnimationFrame(animateNum);

// Month markers
const mm = document.getElementById('monthMarkers');
MONTHS.forEach(m => {
  const el = document.createElement('div');
  el.className = 'mm';
  el.innerHTML = `<div class="dot" style="background:${m.color}"></div>${m.name}: ${m.total.toFixed(2)}"`;
  mm.appendChild(el);
});

// Side stats
const needed = Math.max(0, AVG - TOTAL);
document.getElementById('daysLeft').textContent = REMAINING;
document.getElementById('needed').textContent = needed.toFixed(1) + '"';
document.getElementById('pace').textContent = (needed / REMAINING).toFixed(3) + '"/d';
</script>
<button id="themeToggle" style="position:fixed;top:12px;right:12px;background:var(--bg-card);border:1px solid var(--border);color:var(--muted);padding:4px 10px;border-radius:4px;font:10px/1 monospace;cursor:pointer;z-index:100">Light</button>
<script>
(function(){
  const btn = document.getElementById('themeToggle');
  if(new URLSearchParams(location.search).has('light')){document.body.classList.add('light');btn.textContent='Dark'}
  btn.addEventListener('click', () => {
    document.body.classList.toggle('light');
    btn.textContent = document.body.classList.contains('light') ? 'Dark' : 'Light';
  });
})();
</script>
</body>
</html>
